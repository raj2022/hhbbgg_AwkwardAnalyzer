import subprocess

# List of directories to convert
directories = [
    "NMSSM_X300_Y60", "NMSSM_X300_Y70", "NMSSM_X300_Y80", "NMSSM_X300_Y90", "NMSSM_X300_Y95", 
    "NMSSM_X300_Y100", "NMSSM_X300_Y125", "NMSSM_X300_Y150", "NMSSM_X400_Y60", "NMSSM_X400_Y70",
    "NMSSM_X400_Y80", "NMSSM_X400_Y90", "NMSSM_X400_Y95", "NMSSM_X400_Y100", "NMSSM_X400_Y125",
    "NMSSM_X400_Y150", "NMSSM_X400_Y200", "NMSSM_X500_Y60", "NMSSM_X500_Y70", "NMSSM_X500_Y80",
    "NMSSM_X500_Y90", "NMSSM_X500_Y95", "NMSSM_X500_Y100", "NMSSM_X500_Y125", "NMSSM_X500_Y150",
    "NMSSM_X500_Y200", "NMSSM_X500_Y300", "NMSSM_X550_Y60", "NMSSM_X550_Y70", "NMSSM_X550_Y80",
    "NMSSM_X550_Y90", "NMSSM_X550_Y95", "NMSSM_X550_Y100", "NMSSM_X550_Y125", "NMSSM_X550_Y150",
    "NMSSM_X550_Y200", "NMSSM_X550_Y300", "NMSSM_X550_Y400", "NMSSM_X600_Y60", "NMSSM_X600_Y70",
    "NMSSM_X600_Y80", "NMSSM_X600_Y90", "NMSSM_X600_Y95", "NMSSM_X600_Y100", "NMSSM_X600_Y125",
    "NMSSM_X600_Y150", "NMSSM_X600_Y200", "NMSSM_X600_Y300", "NMSSM_X600_Y400", "NMSSM_X650_Y60",
    "NMSSM_X650_Y70", "NMSSM_X650_Y80", "NMSSM_X650_Y90", "NMSSM_X650_Y100", "NMSSM_X650_Y125",
    "NMSSM_X650_Y150", "NMSSM_X650_Y200", "NMSSM_X650_Y300", "NMSSM_X650_Y400", "NMSSM_X650_Y500",
    "NMSSM_X700_Y60", "NMSSM_X700_Y70", "NMSSM_X700_Y80", "NMSSM_X700_Y90", "NMSSM_X700_Y100",
    "NMSSM_X700_Y125", "NMSSM_X700_Y150", "NMSSM_X700_Y200", "NMSSM_X700_Y300", "NMSSM_X700_Y400",
    "NMSSM_X700_Y500", "NMSSM_X800_Y60", "NMSSM_X800_Y70", "NMSSM_X800_Y80", "NMSSM_X800_Y90",
    "NMSSM_X800_Y95", "NMSSM_X800_Y100", "NMSSM_X800_Y125", "NMSSM_X800_Y150", "NMSSM_X800_Y200",
    "NMSSM_X800_Y300", "NMSSM_X800_Y400", "NMSSM_X800_Y500", "NMSSM_X800_Y600", "NMSSM_X900_Y60",
    "NMSSM_X900_Y70", "NMSSM_X900_Y80", "NMSSM_X900_Y90", "NMSSM_X900_Y95", "NMSSM_X900_Y100",
    "NMSSM_X900_Y125", "NMSSM_X900_Y150", "NMSSM_X900_Y200", "NMSSM_X900_Y300", "NMSSM_X900_Y400",
    "NMSSM_X900_Y500", "NMSSM_X900_Y600", "NMSSM_X1000_Y60", "NMSSM_X1000_Y70", "NMSSM_X1000_Y80",
    "NMSSM_X1000_Y90", "NMSSM_X1000_Y95", "NMSSM_X1000_Y100", "NMSSM_X1000_Y125", "NMSSM_X1000_Y150",
    "NMSSM_X1000_Y200", "NMSSM_X1000_Y300", "NMSSM_X1000_Y400", "NMSSM_X1000_Y500", "NMSSM_X1000_Y600",
    "NMSSM_X1200_Y60", "NMSSM_X1200_Y70", "NMSSM_X1200_Y80", "NMSSM_X1200_Y90", "NMSSM_X1200_Y95",
    "NMSSM_X1200_Y100", "NMSSM_X1200_Y125", "NMSSM_X1200_Y150", "NMSSM_X1200_Y200", "NMSSM_X1200_Y400",
    "NMSSM_X1200_Y600", "NMSSM_X1200_Y800", "NMSSM_X1200_Y1000", "NMSSM_X1400_Y60", "NMSSM_X1400_Y70",
    "NMSSM_X1400_Y80", "NMSSM_X1400_Y90", "NMSSM_X1400_Y95", "NMSSM_X1400_Y100", "NMSSM_X1400_Y125",
    "NMSSM_X1400_Y150", "NMSSM_X1400_Y200", "NMSSM_X1400_Y300", "NMSSM_X1400_Y400", "NMSSM_X1400_Y500",
    "NMSSM_X1400_Y600", "NMSSM_X1400_Y800", "NMSSM_X1400_Y1000", "NMSSM_X1400_Y1200", "NMSSM_X1400_Y1000"
]

# Base input and output paths
input_base = "../../../output_parquet/v2_production/merged/"
output_base = "../../../output_root/v2_production/signal_NMSSM/"

# Loop over each directory and run the conversion
for directory in directories:
    input_file = f"{input_base}{directory}/nominal/NOTAG_merged.parquet"
    output_file = f"{output_base}{directory}.root"
    
    # Run the conversion script
    command = [
        "python3", "scripts/postprocessing/convert_parquet_to_root.py",
        input_file, output_file, "mc"
    ]
    
    try:
        subprocess.run(command, check=True)
        print(f"Successfully converted {directory}")
    except subprocess.CalledProcessError as e:
        print(f"Error converting {directory}: {e}")

