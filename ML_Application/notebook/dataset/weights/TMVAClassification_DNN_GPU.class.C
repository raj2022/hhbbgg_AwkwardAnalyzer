// Class: ReadDNN_GPU
// Automatically generated by MethodBase::MakeClass
//

/* configuration options =====================================================

#GEN -*-*-*-*-*-*-*-*-*-*-*- general info -*-*-*-*-*-*-*-*-*-*-*-

Method         : DL::DNN_GPU
TMVA Release   : 4.2.1         [262657]
ROOT Release   : 6.30/04       [400900]
Creator        : ptiwari
Date           : Sat Jul 20 03:20:14 2024
Host           : Darwin ChristohersMBP8.localdomain 23.1.0 Darwin Kernel Version 23.1.0: Mon Oct 9 21:27:24 PDT 2023; root:xnu-10002.41.9~6/RELEASE_ARM64_T6000 arm64
Dir            : /Users/ptiwari/Development/hepProjects/hhbbgg_AwkwardAnalyzer/bdt/notebook
Training events: 20000
Analysis type  : [Classification]


#OPT -*-*-*-*-*-*-*-*-*-*-*-*- options -*-*-*-*-*-*-*-*-*-*-*-*-

# Set by User:
V: "True" [Verbose output (short form of "VerbosityLevel" below - overrides the latter one)]
VarTransform: "N" [List of variable transformations performed before training, e.g., "D_Background,P_Signal,G,N_AllClasses" for: "Decorrelation, PCA-transformation, Gaussianisation, Normalisation, each for the given class of events ('AllClasses' denotes all events of all classes, if no class indication is given, 'All' is assumed)"]
H: "False" [Print method-specific help message]
Layout: "TANH|128,TANH|128,TANH|128,LINEAR" [Layout of the network.]
ErrorStrategy: "CROSSENTROPY" [Loss function: Mean squared error (regression) or cross entropy (binary classification).]
WeightInitialization: "XAVIERUNIFORM" [Weight initialization strategy]
TrainingStrategy: "LearningRate=1e-2,Momentum=0.9,ConvergenceSteps=20,BatchSize=100,TestRepetitions=1,WeightDecay=1e-4,Regularization=None,DropConfig=0.0+0.5+0.5+0.5" [Defines the training strategies.]
# Default:
VerbosityLevel: "Verbose" [Verbosity level]
CreateMVAPdfs: "False" [Create PDFs for classifier outputs (signal and background)]
IgnoreNegWeightsInTraining: "False" [Events with negative weights are ignored in the training (but are included for testing and performance evaluation)]
InputLayout: "0|0|0" [The Layout of the input]
BatchLayout: "0|0|0" [The Layout of the batch]
RandomSeed: "0" [Random seed used for weight initialization and batch shuffling]
ValidationSize: "20%" [Part of the training data to use for validation. Specify as 0.2 or 20% to use a fifth of the data set as validation set. Specify as 100 to use exactly 100 events. (Default: 20%)]
Architecture: "CPU" [Which architecture to perform the training on.]
##


#VAR -*-*-*-*-*-*-*-*-*-*-*-* variables *-*-*-*-*-*-*-*-*-*-*-*-

NVar 30
bbgg_mass                     bbgg_mass                     bbgg_mass                     bbgg_mass                                                       'F'    [158.398681641,2574.74707031]
dibjet_pt                     dibjet_pt                     dibjet_pt                     dibjet_pt                                                       'F'    [0.204869583249,1259.89660645]
diphoton_pt                   diphoton_pt                   diphoton_pt                   diphoton_pt                                                     'F'    [0.6357640028,914.014404297]
bbgg_pt                       bbgg_pt                       bbgg_pt                       bbgg_pt                                                         'F'    [0.0856400057673,1380.28662109]
bbgg_eta                      bbgg_eta                      bbgg_eta                      bbgg_eta                                                        'F'    [-8.11046504974,7.80849409103]
bbgg_phi                      bbgg_phi                      bbgg_phi                      bbgg_phi                                                        'F'    [-3.14034366608,3.14087224007]
lead_pho_eta                  lead_pho_eta                  lead_pho_eta                  lead_pho_eta                                                    'F'    [-2.498046875,2.4912109375]
lead_pho_phi                  lead_pho_phi                  lead_pho_phi                  lead_pho_phi                                                    'F'    [-3.14111328125,3.1416015625]
sublead_pho_eta               sublead_pho_eta               sublead_pho_eta               sublead_pho_eta                                                 'F'    [-2.49755859375,2.49853515625]
sublead_pho_phi               sublead_pho_phi               sublead_pho_phi               sublead_pho_phi                                                 'F'    [-3.14111328125,3.1416015625]
diphoton_eta                  diphoton_eta                  diphoton_eta                  diphoton_eta                                                    'F'    [-7.45361614227,6.76777505875]
diphoton_phi                  diphoton_phi                  diphoton_phi                  diphoton_phi                                                    'F'    [-3.14087605476,3.14152669907]
dibjet_eta                    dibjet_eta                    dibjet_eta                    dibjet_eta                                                      'F'    [-7.01819610596,5.95133161545]
dibjet_phi                    dibjet_phi                    dibjet_phi                    dibjet_phi                                                      'F'    [-3.14155006409,3.14098858833]
sublead_bjet_pt               sublead_bjet_pt               sublead_bjet_pt               sublead_bjet_pt                                                 'F'    [20.015625,319]
lead_bjet_phi                 lead_bjet_phi                 lead_bjet_phi                 lead_bjet_phi                                                   'F'    [-3.1416015625,3.140625]
sublead_bjet_eta              sublead_bjet_eta              sublead_bjet_eta              sublead_bjet_eta                                                'F'    [-2.49951171875,2.49951171875]
sublead_bjet_phi              sublead_bjet_phi              sublead_bjet_phi              sublead_bjet_phi                                                'F'    [-3.1416015625,3.140625]
sublead_bjet_PNetB            sublead_bjet_PNetB            sublead_bjet_PNetB            sublead_bjet_PNetB                                              'F'    [0.00122833251953,0.99951171875]
lead_bjet_PNetB               lead_bjet_PNetB               lead_bjet_PNetB               lead_bjet_PNetB                                                 'F'    [0.00070858001709,0.99951171875]
CosThetaStar_gg               CosThetaStar_gg               CosThetaStar_gg               CosThetaStar_gg                                                 'F'    [-0.999931812286,0.999846160412]
CosThetaStar_jj               CosThetaStar_jj               CosThetaStar_jj               CosThetaStar_jj                                                 'F'    [-0.999996006489,0.999922454357]
CosThetaStar_CS               CosThetaStar_CS               CosThetaStar_CS               CosThetaStar_CS                                                 'F'    [-0.999989688396,0.999987244606]
DeltaR_jg_min                 DeltaR_jg_min                 DeltaR_jg_min                 DeltaR_jg_min                                                   'F'    [0.400275558233,4.28595256805]
pholead_PtOverM               pholead_PtOverM               pholead_PtOverM               pholead_PtOverM                                                 'F'    [0.334028601646,6.80878973007]
phosublead_PtOverM            phosublead_PtOverM            phosublead_PtOverM            phosublead_PtOverM                                              'F'    [0.250040501356,2.88749480247]
FirstJet_PtOverM              FirstJet_PtOverM              FirstJet_PtOverM              FirstJet_PtOverM                                                'F'    [0.111182250082,9.55922031403]
SecondJet_PtOverM             SecondJet_PtOverM             SecondJet_PtOverM             SecondJet_PtOverM                                               'F'    [0.106673195958,2.3555893898]
diphoton_bbgg_mass            diphoton_bbgg_mass            diphoton_bbgg_mass            diphoton_bbgg_mass                                              'F'    [0.00133723113686,1.645362854]
dibjet_bbgg_mass              dibjet_bbgg_mass              dibjet_bbgg_mass              dibjet_bbgg_mass                                                'F'    [0.000732800283004,1.67565762997]
NSpec 0


============================================================================ */

#include <array>
#include <vector>
#include <cmath>
#include <string>
#include <iostream>

#ifndef IClassifierReader__def
#define IClassifierReader__def

class IClassifierReader {

 public:

   // constructor
   IClassifierReader() : fStatusIsClean( true ) {}
   virtual ~IClassifierReader() {}

   // return classifier response
   virtual std::vector<double> GetMulticlassValues( const std::vector<double>& inputValues ) const = 0;

   // returns classifier status
   bool IsStatusClean() const { return fStatusIsClean; }

 protected:

   bool fStatusIsClean;
};

#endif

class ReadDNN_GPU : public IClassifierReader {

 public:

   // constructor
   ReadDNN_GPU( std::vector<std::string>& theInputVars )
      : IClassifierReader(),
        fClassName( "ReadDNN_GPU" ),
        fNvars( 30 )
   {
      // the training input variables
      const char* inputVars[] = { "bbgg_mass", "dibjet_pt", "diphoton_pt", "bbgg_pt", "bbgg_eta", "bbgg_phi", "lead_pho_eta", "lead_pho_phi", "sublead_pho_eta", "sublead_pho_phi", "diphoton_eta", "diphoton_phi", "dibjet_eta", "dibjet_phi", "sublead_bjet_pt", "lead_bjet_phi", "sublead_bjet_eta", "sublead_bjet_phi", "sublead_bjet_PNetB", "lead_bjet_PNetB", "CosThetaStar_gg", "CosThetaStar_jj", "CosThetaStar_CS", "DeltaR_jg_min", "pholead_PtOverM", "phosublead_PtOverM", "FirstJet_PtOverM", "SecondJet_PtOverM", "diphoton_bbgg_mass", "dibjet_bbgg_mass" };

      // sanity checks
      if (theInputVars.size() <= 0) {
         std::cout << "Problem in class \"" << fClassName << "\": empty input vector" << std::endl;
         fStatusIsClean = false;
      }

      if (theInputVars.size() != fNvars) {
         std::cout << "Problem in class \"" << fClassName << "\": mismatch in number of input values: "
                   << theInputVars.size() << " != " << fNvars << std::endl;
         fStatusIsClean = false;
      }

      // validate input variables
      for (size_t ivar = 0; ivar < theInputVars.size(); ivar++) {
         if (theInputVars[ivar] != inputVars[ivar]) {
            std::cout << "Problem in class \"" << fClassName << "\": mismatch in input variable names" << std::endl
                      << " for variable [" << ivar << "]: " << theInputVars[ivar].c_str() << " != " << inputVars[ivar] << std::endl;
            fStatusIsClean = false;
         }
      }

      // initialize min and max vectors (for normalisation)
      fVmin[0] = -1;
      fVmax[0] = 1;
      fVmin[1] = -1;
      fVmax[1] = 1;
      fVmin[2] = -1;
      fVmax[2] = 1;
      fVmin[3] = -1;
      fVmax[3] = 1;
      fVmin[4] = -1;
      fVmax[4] = 0.99999988079071;
      fVmin[5] = -1;
      fVmax[5] = 1;
      fVmin[6] = -1;
      fVmax[6] = 1;
      fVmin[7] = -1;
      fVmax[7] = 1;
      fVmin[8] = -1;
      fVmax[8] = 1;
      fVmin[9] = -1;
      fVmax[9] = 1;
      fVmin[10] = -1;
      fVmax[10] = 1;
      fVmin[11] = -1;
      fVmax[11] = 0.99999988079071;
      fVmin[12] = -1;
      fVmax[12] = 1;
      fVmin[13] = -1;
      fVmax[13] = 1;
      fVmin[14] = -1;
      fVmax[14] = 1;
      fVmin[15] = -1;
      fVmax[15] = 0.99999988079071;
      fVmin[16] = -1;
      fVmax[16] = 1;
      fVmin[17] = -1;
      fVmax[17] = 0.99999988079071;
      fVmin[18] = -1;
      fVmax[18] = 1;
      fVmin[19] = -1;
      fVmax[19] = 1;
      fVmin[20] = -1;
      fVmax[20] = 1;
      fVmin[21] = -1;
      fVmax[21] = 1;
      fVmin[22] = -1;
      fVmax[22] = 1;
      fVmin[23] = -1;
      fVmax[23] = 0.99999988079071;
      fVmin[24] = -1;
      fVmax[24] = 1;
      fVmin[25] = -1;
      fVmax[25] = 1;
      fVmin[26] = -1;
      fVmax[26] = 0.99999988079071;
      fVmin[27] = -1;
      fVmax[27] = 1;
      fVmin[28] = -1;
      fVmax[28] = 1;
      fVmin[29] = -1;
      fVmax[29] = 1;

      // initialize input variable types
      fType[0] = 'F';
      fType[1] = 'F';
      fType[2] = 'F';
      fType[3] = 'F';
      fType[4] = 'F';
      fType[5] = 'F';
      fType[6] = 'F';
      fType[7] = 'F';
      fType[8] = 'F';
      fType[9] = 'F';
      fType[10] = 'F';
      fType[11] = 'F';
      fType[12] = 'F';
      fType[13] = 'F';
      fType[14] = 'F';
      fType[15] = 'F';
      fType[16] = 'F';
      fType[17] = 'F';
      fType[18] = 'F';
      fType[19] = 'F';
      fType[20] = 'F';
      fType[21] = 'F';
      fType[22] = 'F';
      fType[23] = 'F';
      fType[24] = 'F';
      fType[25] = 'F';
      fType[26] = 'F';
      fType[27] = 'F';
      fType[28] = 'F';
      fType[29] = 'F';

      // initialize constants
      Initialize();

      // initialize transformation
      InitTransform();
   }

   // destructor
   virtual ~ReadDNN_GPU() {
      Clear(); // method-specific
   }

   // the classifier response
   // "inputValues" is a vector of input values in the same order as the
   // variables given to the constructor
   std::vector<double> GetMulticlassValues( const std::vector<double>& inputValues ) const override;

 private:

   // method-specific destructor
   void Clear();

   // input variable transformation

   double fOff_1[3][30];
   double fScal_1[3][30];
   void InitTransform_1();
   void Transform_1( std::vector<double> & iv, int sigOrBgd ) const;
   void InitTransform();
   void Transform( std::vector<double> & iv, int sigOrBgd ) const;

   // common member variables
   const char* fClassName;

   const size_t fNvars;
   size_t GetNvar()           const { return fNvars; }
   char   GetType( int ivar ) const { return fType[ivar]; }

   // normalisation of input variables
   double fVmin[30];
   double fVmax[30];
   double NormVariable( double x, double xmin, double xmax ) const {
      // normalise to output range: [-1, 1]
      return 2*(x - xmin)/(xmax - xmin) - 1.0;
   }

   // type of input variable: 'F' or 'I'
   char   fType[30];

   // initialize internal variables
   void Initialize();
   std::vector<double> GetMulticlassValues__( const std::vector<double>& inputValues ) const;

   // private members (method specific)
inline std::vector<double> ReadDNN_GPU::GetMulticlassValues( const std::vector<double>& inputValues ) const
{
   // classifier response value
   std::vector<double> retval;

   // classifier response, sanity check first
   if (!IsStatusClean()) {
      std::cout << "Problem in class \"" << fClassName << "\": cannot return classifier response"
                << " because status is dirty" << std::endl;
   }
   else {
         std::vector<double> iV(inputValues);
         Transform( iV, -1 );
         retval = GetMulticlassValues__( iV );
   }

   return retval;
}

//_______________________________________________________________________
inline void ReadDNN_GPU::InitTransform_1()
{
   double fMin_1[3][30];
   double fMax_1[3][30];
   // Normalization transformation, initialisation
   fMin_1[0][0] = 201.510665894;
   fMax_1[0][0] = 2071.32421875;
   fScal_1[0][0] = 2.0/(fMax_1[0][0]-fMin_1[0][0]);
   fOff_1[0][0] = fMin_1[0][0]*fScal_1[0][0]+1.;
   fMin_1[1][0] = 158.398681641;
   fMax_1[1][0] = 2574.74707031;
   fScal_1[1][0] = 2.0/(fMax_1[1][0]-fMin_1[1][0]);
   fOff_1[1][0] = fMin_1[1][0]*fScal_1[1][0]+1.;
   fMin_1[2][0] = 158.398681641;
   fMax_1[2][0] = 2574.74707031;
   fScal_1[2][0] = 2.0/(fMax_1[2][0]-fMin_1[2][0]);
   fOff_1[2][0] = fMin_1[2][0]*fScal_1[2][0]+1.;
   fMin_1[0][1] = 1.02322125435;
   fMax_1[0][1] = 778.096862793;
   fScal_1[0][1] = 2.0/(fMax_1[0][1]-fMin_1[0][1]);
   fOff_1[0][1] = fMin_1[0][1]*fScal_1[0][1]+1.;
   fMin_1[1][1] = 0.204869583249;
   fMax_1[1][1] = 1259.89660645;
   fScal_1[1][1] = 2.0/(fMax_1[1][1]-fMin_1[1][1]);
   fOff_1[1][1] = fMin_1[1][1]*fScal_1[1][1]+1.;
   fMin_1[2][1] = 0.204869583249;
   fMax_1[2][1] = 1259.89660645;
   fScal_1[2][1] = 2.0/(fMax_1[2][1]-fMin_1[2][1]);
   fOff_1[2][1] = fMin_1[2][1]*fScal_1[2][1]+1.;
   fMin_1[0][2] = 1.79701709747;
   fMax_1[0][2] = 914.014404297;
   fScal_1[0][2] = 2.0/(fMax_1[0][2]-fMin_1[0][2]);
   fOff_1[0][2] = fMin_1[0][2]*fScal_1[0][2]+1.;
   fMin_1[1][2] = 0.6357640028;
   fMax_1[1][2] = 741.666381836;
   fScal_1[1][2] = 2.0/(fMax_1[1][2]-fMin_1[1][2]);
   fOff_1[1][2] = fMin_1[1][2]*fScal_1[1][2]+1.;
   fMin_1[2][2] = 0.6357640028;
   fMax_1[2][2] = 914.014404297;
   fScal_1[2][2] = 2.0/(fMax_1[2][2]-fMin_1[2][2]);
   fOff_1[2][2] = fMin_1[2][2]*fScal_1[2][2]+1.;
   fMin_1[0][3] = 0.0856400057673;
   fMax_1[0][3] = 947.65411377;
   fScal_1[0][3] = 2.0/(fMax_1[0][3]-fMin_1[0][3]);
   fOff_1[0][3] = fMin_1[0][3]*fScal_1[0][3]+1.;
   fMin_1[1][3] = 0.399734973907;
   fMax_1[1][3] = 1380.28662109;
   fScal_1[1][3] = 2.0/(fMax_1[1][3]-fMin_1[1][3]);
   fOff_1[1][3] = fMin_1[1][3]*fScal_1[1][3]+1.;
   fMin_1[2][3] = 0.0856400057673;
   fMax_1[2][3] = 1380.28662109;
   fScal_1[2][3] = 2.0/(fMax_1[2][3]-fMin_1[2][3]);
   fOff_1[2][3] = fMin_1[2][3]*fScal_1[2][3]+1.;
   fMin_1[0][4] = -7.03063726425;
   fMax_1[0][4] = 7.80849409103;
   fScal_1[0][4] = 2.0/(fMax_1[0][4]-fMin_1[0][4]);
   fOff_1[0][4] = fMin_1[0][4]*fScal_1[0][4]+1.;
   fMin_1[1][4] = -8.11046504974;
   fMax_1[1][4] = 7.11973571777;
   fScal_1[1][4] = 2.0/(fMax_1[1][4]-fMin_1[1][4]);
   fOff_1[1][4] = fMin_1[1][4]*fScal_1[1][4]+1.;
   fMin_1[2][4] = -8.11046504974;
   fMax_1[2][4] = 7.80849409103;
   fScal_1[2][4] = 2.0/(fMax_1[2][4]-fMin_1[2][4]);
   fOff_1[2][4] = fMin_1[2][4]*fScal_1[2][4]+1.;
   fMin_1[0][5] = -3.14034366608;
   fMax_1[0][5] = 3.14087224007;
   fScal_1[0][5] = 2.0/(fMax_1[0][5]-fMin_1[0][5]);
   fOff_1[0][5] = fMin_1[0][5]*fScal_1[0][5]+1.;
   fMin_1[1][5] = -3.13999557495;
   fMax_1[1][5] = 3.14055991173;
   fScal_1[1][5] = 2.0/(fMax_1[1][5]-fMin_1[1][5]);
   fOff_1[1][5] = fMin_1[1][5]*fScal_1[1][5]+1.;
   fMin_1[2][5] = -3.14034366608;
   fMax_1[2][5] = 3.14087224007;
   fScal_1[2][5] = 2.0/(fMax_1[2][5]-fMin_1[2][5]);
   fOff_1[2][5] = fMin_1[2][5]*fScal_1[2][5]+1.;
   fMin_1[0][6] = -2.49169921875;
   fMax_1[0][6] = 2.4873046875;
   fScal_1[0][6] = 2.0/(fMax_1[0][6]-fMin_1[0][6]);
   fOff_1[0][6] = fMin_1[0][6]*fScal_1[0][6]+1.;
   fMin_1[1][6] = -2.498046875;
   fMax_1[1][6] = 2.4912109375;
   fScal_1[1][6] = 2.0/(fMax_1[1][6]-fMin_1[1][6]);
   fOff_1[1][6] = fMin_1[1][6]*fScal_1[1][6]+1.;
   fMin_1[2][6] = -2.498046875;
   fMax_1[2][6] = 2.4912109375;
   fScal_1[2][6] = 2.0/(fMax_1[2][6]-fMin_1[2][6]);
   fOff_1[2][6] = fMin_1[2][6]*fScal_1[2][6]+1.;
   fMin_1[0][7] = -3.14013671875;
   fMax_1[0][7] = 3.1416015625;
   fScal_1[0][7] = 2.0/(fMax_1[0][7]-fMin_1[0][7]);
   fOff_1[0][7] = fMin_1[0][7]*fScal_1[0][7]+1.;
   fMin_1[1][7] = -3.14111328125;
   fMax_1[1][7] = 3.1416015625;
   fScal_1[1][7] = 2.0/(fMax_1[1][7]-fMin_1[1][7]);
   fOff_1[1][7] = fMin_1[1][7]*fScal_1[1][7]+1.;
   fMin_1[2][7] = -3.14111328125;
   fMax_1[2][7] = 3.1416015625;
   fScal_1[2][7] = 2.0/(fMax_1[2][7]-fMin_1[2][7]);
   fOff_1[2][7] = fMin_1[2][7]*fScal_1[2][7]+1.;
   fMin_1[0][8] = -2.4970703125;
   fMax_1[0][8] = 2.4912109375;
   fScal_1[0][8] = 2.0/(fMax_1[0][8]-fMin_1[0][8]);
   fOff_1[0][8] = fMin_1[0][8]*fScal_1[0][8]+1.;
   fMin_1[1][8] = -2.49755859375;
   fMax_1[1][8] = 2.49853515625;
   fScal_1[1][8] = 2.0/(fMax_1[1][8]-fMin_1[1][8]);
   fOff_1[1][8] = fMin_1[1][8]*fScal_1[1][8]+1.;
   fMin_1[2][8] = -2.49755859375;
   fMax_1[2][8] = 2.49853515625;
   fScal_1[2][8] = 2.0/(fMax_1[2][8]-fMin_1[2][8]);
   fOff_1[2][8] = fMin_1[2][8]*fScal_1[2][8]+1.;
   fMin_1[0][9] = -3.14111328125;
   fMax_1[0][9] = 3.1416015625;
   fScal_1[0][9] = 2.0/(fMax_1[0][9]-fMin_1[0][9]);
   fOff_1[0][9] = fMin_1[0][9]*fScal_1[0][9]+1.;
   fMin_1[1][9] = -3.14111328125;
   fMax_1[1][9] = 3.1416015625;
   fScal_1[1][9] = 2.0/(fMax_1[1][9]-fMin_1[1][9]);
   fOff_1[1][9] = fMin_1[1][9]*fScal_1[1][9]+1.;
   fMin_1[2][9] = -3.14111328125;
   fMax_1[2][9] = 3.1416015625;
   fScal_1[2][9] = 2.0/(fMax_1[2][9]-fMin_1[2][9]);
   fOff_1[2][9] = fMin_1[2][9]*fScal_1[2][9]+1.;
   fMin_1[0][10] = -4.87402582169;
   fMax_1[0][10] = 4.77416181564;
   fScal_1[0][10] = 2.0/(fMax_1[0][10]-fMin_1[0][10]);
   fOff_1[0][10] = fMin_1[0][10]*fScal_1[0][10]+1.;
   fMin_1[1][10] = -7.45361614227;
   fMax_1[1][10] = 6.76777505875;
   fScal_1[1][10] = 2.0/(fMax_1[1][10]-fMin_1[1][10]);
   fOff_1[1][10] = fMin_1[1][10]*fScal_1[1][10]+1.;
   fMin_1[2][10] = -7.45361614227;
   fMax_1[2][10] = 6.76777505875;
   fScal_1[2][10] = 2.0/(fMax_1[2][10]-fMin_1[2][10]);
   fOff_1[2][10] = fMin_1[2][10]*fScal_1[2][10]+1.;
   fMin_1[0][11] = -3.14067006111;
   fMax_1[0][11] = 3.14082407951;
   fScal_1[0][11] = 2.0/(fMax_1[0][11]-fMin_1[0][11]);
   fOff_1[0][11] = fMin_1[0][11]*fScal_1[0][11]+1.;
   fMin_1[1][11] = -3.14087605476;
   fMax_1[1][11] = 3.14152669907;
   fScal_1[1][11] = 2.0/(fMax_1[1][11]-fMin_1[1][11]);
   fOff_1[1][11] = fMin_1[1][11]*fScal_1[1][11]+1.;
   fMin_1[2][11] = -3.14087605476;
   fMax_1[2][11] = 3.14152669907;
   fScal_1[2][11] = 2.0/(fMax_1[2][11]-fMin_1[2][11]);
   fOff_1[2][11] = fMin_1[2][11]*fScal_1[2][11]+1.;
   fMin_1[0][12] = -5.30349159241;
   fMax_1[0][12] = 5.81761169434;
   fScal_1[0][12] = 2.0/(fMax_1[0][12]-fMin_1[0][12]);
   fOff_1[0][12] = fMin_1[0][12]*fScal_1[0][12]+1.;
   fMin_1[1][12] = -7.01819610596;
   fMax_1[1][12] = 5.95133161545;
   fScal_1[1][12] = 2.0/(fMax_1[1][12]-fMin_1[1][12]);
   fOff_1[1][12] = fMin_1[1][12]*fScal_1[1][12]+1.;
   fMin_1[2][12] = -7.01819610596;
   fMax_1[2][12] = 5.95133161545;
   fScal_1[2][12] = 2.0/(fMax_1[2][12]-fMin_1[2][12]);
   fOff_1[2][12] = fMin_1[2][12]*fScal_1[2][12]+1.;
   fMin_1[0][13] = -3.14117860794;
   fMax_1[0][13] = 3.14098858833;
   fScal_1[0][13] = 2.0/(fMax_1[0][13]-fMin_1[0][13]);
   fOff_1[0][13] = fMin_1[0][13]*fScal_1[0][13]+1.;
   fMin_1[1][13] = -3.14155006409;
   fMax_1[1][13] = 3.14024209976;
   fScal_1[1][13] = 2.0/(fMax_1[1][13]-fMin_1[1][13]);
   fOff_1[1][13] = fMin_1[1][13]*fScal_1[1][13]+1.;
   fMin_1[2][13] = -3.14155006409;
   fMax_1[2][13] = 3.14098858833;
   fScal_1[2][13] = 2.0/(fMax_1[2][13]-fMin_1[2][13]);
   fOff_1[2][13] = fMin_1[2][13]*fScal_1[2][13]+1.;
   fMin_1[0][14] = 20.015625;
   fMax_1[0][14] = 319;
   fScal_1[0][14] = 2.0/(fMax_1[0][14]-fMin_1[0][14]);
   fOff_1[0][14] = fMin_1[0][14]*fScal_1[0][14]+1.;
   fMin_1[1][14] = 20.015625;
   fMax_1[1][14] = 207.5;
   fScal_1[1][14] = 2.0/(fMax_1[1][14]-fMin_1[1][14]);
   fOff_1[1][14] = fMin_1[1][14]*fScal_1[1][14]+1.;
   fMin_1[2][14] = 20.015625;
   fMax_1[2][14] = 319;
   fScal_1[2][14] = 2.0/(fMax_1[2][14]-fMin_1[2][14]);
   fOff_1[2][14] = fMin_1[2][14]*fScal_1[2][14]+1.;
   fMin_1[0][15] = -3.1416015625;
   fMax_1[0][15] = 3.1396484375;
   fScal_1[0][15] = 2.0/(fMax_1[0][15]-fMin_1[0][15]);
   fOff_1[0][15] = fMin_1[0][15]*fScal_1[0][15]+1.;
   fMin_1[1][15] = -3.1416015625;
   fMax_1[1][15] = 3.140625;
   fScal_1[1][15] = 2.0/(fMax_1[1][15]-fMin_1[1][15]);
   fOff_1[1][15] = fMin_1[1][15]*fScal_1[1][15]+1.;
   fMin_1[2][15] = -3.1416015625;
   fMax_1[2][15] = 3.140625;
   fScal_1[2][15] = 2.0/(fMax_1[2][15]-fMin_1[2][15]);
   fOff_1[2][15] = fMin_1[2][15]*fScal_1[2][15]+1.;
   fMin_1[0][16] = -2.49755859375;
   fMax_1[0][16] = 2.498046875;
   fScal_1[0][16] = 2.0/(fMax_1[0][16]-fMin_1[0][16]);
   fOff_1[0][16] = fMin_1[0][16]*fScal_1[0][16]+1.;
   fMin_1[1][16] = -2.49951171875;
   fMax_1[1][16] = 2.49951171875;
   fScal_1[1][16] = 2.0/(fMax_1[1][16]-fMin_1[1][16]);
   fOff_1[1][16] = fMin_1[1][16]*fScal_1[1][16]+1.;
   fMin_1[2][16] = -2.49951171875;
   fMax_1[2][16] = 2.49951171875;
   fScal_1[2][16] = 2.0/(fMax_1[2][16]-fMin_1[2][16]);
   fOff_1[2][16] = fMin_1[2][16]*fScal_1[2][16]+1.;
   fMin_1[0][17] = -3.140625;
   fMax_1[0][17] = 3.140625;
   fScal_1[0][17] = 2.0/(fMax_1[0][17]-fMin_1[0][17]);
   fOff_1[0][17] = fMin_1[0][17]*fScal_1[0][17]+1.;
   fMin_1[1][17] = -3.1416015625;
   fMax_1[1][17] = 3.13818359375;
   fScal_1[1][17] = 2.0/(fMax_1[1][17]-fMin_1[1][17]);
   fOff_1[1][17] = fMin_1[1][17]*fScal_1[1][17]+1.;
   fMin_1[2][17] = -3.1416015625;
   fMax_1[2][17] = 3.140625;
   fScal_1[2][17] = 2.0/(fMax_1[2][17]-fMin_1[2][17]);
   fOff_1[2][17] = fMin_1[2][17]*fScal_1[2][17]+1.;
   fMin_1[0][18] = 0.00167465209961;
   fMax_1[0][18] = 0.99951171875;
   fScal_1[0][18] = 2.0/(fMax_1[0][18]-fMin_1[0][18]);
   fOff_1[0][18] = fMin_1[0][18]*fScal_1[0][18]+1.;
   fMin_1[1][18] = 0.00122833251953;
   fMax_1[1][18] = 0.99951171875;
   fScal_1[1][18] = 2.0/(fMax_1[1][18]-fMin_1[1][18]);
   fOff_1[1][18] = fMin_1[1][18]*fScal_1[1][18]+1.;
   fMin_1[2][18] = 0.00122833251953;
   fMax_1[2][18] = 0.99951171875;
   fScal_1[2][18] = 2.0/(fMax_1[2][18]-fMin_1[2][18]);
   fOff_1[2][18] = fMin_1[2][18]*fScal_1[2][18]+1.;
   fMin_1[0][19] = 0.00106716156006;
   fMax_1[0][19] = 0.99951171875;
   fScal_1[0][19] = 2.0/(fMax_1[0][19]-fMin_1[0][19]);
   fOff_1[0][19] = fMin_1[0][19]*fScal_1[0][19]+1.;
   fMin_1[1][19] = 0.00070858001709;
   fMax_1[1][19] = 0.99951171875;
   fScal_1[1][19] = 2.0/(fMax_1[1][19]-fMin_1[1][19]);
   fOff_1[1][19] = fMin_1[1][19]*fScal_1[1][19]+1.;
   fMin_1[2][19] = 0.00070858001709;
   fMax_1[2][19] = 0.99951171875;
   fScal_1[2][19] = 2.0/(fMax_1[2][19]-fMin_1[2][19]);
   fOff_1[2][19] = fMin_1[2][19]*fScal_1[2][19]+1.;
   fMin_1[0][20] = -0.999931812286;
   fMax_1[0][20] = 0.999846160412;
   fScal_1[0][20] = 2.0/(fMax_1[0][20]-fMin_1[0][20]);
   fOff_1[0][20] = fMin_1[0][20]*fScal_1[0][20]+1.;
   fMin_1[1][20] = -0.999426603317;
   fMax_1[1][20] = 0.996839761734;
   fScal_1[1][20] = 2.0/(fMax_1[1][20]-fMin_1[1][20]);
   fOff_1[1][20] = fMin_1[1][20]*fScal_1[1][20]+1.;
   fMin_1[2][20] = -0.999931812286;
   fMax_1[2][20] = 0.999846160412;
   fScal_1[2][20] = 2.0/(fMax_1[2][20]-fMin_1[2][20]);
   fOff_1[2][20] = fMin_1[2][20]*fScal_1[2][20]+1.;
   fMin_1[0][21] = -0.999854981899;
   fMax_1[0][21] = 0.999734520912;
   fScal_1[0][21] = 2.0/(fMax_1[0][21]-fMin_1[0][21]);
   fOff_1[0][21] = fMin_1[0][21]*fScal_1[0][21]+1.;
   fMin_1[1][21] = -0.999996006489;
   fMax_1[1][21] = 0.999922454357;
   fScal_1[1][21] = 2.0/(fMax_1[1][21]-fMin_1[1][21]);
   fOff_1[1][21] = fMin_1[1][21]*fScal_1[1][21]+1.;
   fMin_1[2][21] = -0.999996006489;
   fMax_1[2][21] = 0.999922454357;
   fScal_1[2][21] = 2.0/(fMax_1[2][21]-fMin_1[2][21]);
   fOff_1[2][21] = fMin_1[2][21]*fScal_1[2][21]+1.;
   fMin_1[0][22] = -0.999646306038;
   fMax_1[0][22] = 0.999481856823;
   fScal_1[0][22] = 2.0/(fMax_1[0][22]-fMin_1[0][22]);
   fOff_1[0][22] = fMin_1[0][22]*fScal_1[0][22]+1.;
   fMin_1[1][22] = -0.999989688396;
   fMax_1[1][22] = 0.999987244606;
   fScal_1[1][22] = 2.0/(fMax_1[1][22]-fMin_1[1][22]);
   fOff_1[1][22] = fMin_1[1][22]*fScal_1[1][22]+1.;
   fMin_1[2][22] = -0.999989688396;
   fMax_1[2][22] = 0.999987244606;
   fScal_1[2][22] = 2.0/(fMax_1[2][22]-fMin_1[2][22]);
   fOff_1[2][22] = fMin_1[2][22]*fScal_1[2][22]+1.;
   fMin_1[0][23] = 0.402014017105;
   fMax_1[0][23] = 3.62363409996;
   fScal_1[0][23] = 2.0/(fMax_1[0][23]-fMin_1[0][23]);
   fOff_1[0][23] = fMin_1[0][23]*fScal_1[0][23]+1.;
   fMin_1[1][23] = 0.400275558233;
   fMax_1[1][23] = 4.28595256805;
   fScal_1[1][23] = 2.0/(fMax_1[1][23]-fMin_1[1][23]);
   fOff_1[1][23] = fMin_1[1][23]*fScal_1[1][23]+1.;
   fMin_1[2][23] = 0.400275558233;
   fMax_1[2][23] = 4.28595256805;
   fScal_1[2][23] = 2.0/(fMax_1[2][23]-fMin_1[2][23]);
   fOff_1[2][23] = fMin_1[2][23]*fScal_1[2][23]+1.;
   fMin_1[0][24] = 0.337011814117;
   fMax_1[0][24] = 6.80878973007;
   fScal_1[0][24] = 2.0/(fMax_1[0][24]-fMin_1[0][24]);
   fOff_1[0][24] = fMin_1[0][24]*fScal_1[0][24]+1.;
   fMin_1[1][24] = 0.334028601646;
   fMax_1[1][24] = 4.61370706558;
   fScal_1[1][24] = 2.0/(fMax_1[1][24]-fMin_1[1][24]);
   fOff_1[1][24] = fMin_1[1][24]*fScal_1[1][24]+1.;
   fMin_1[2][24] = 0.334028601646;
   fMax_1[2][24] = 6.80878973007;
   fScal_1[2][24] = 2.0/(fMax_1[2][24]-fMin_1[2][24]);
   fOff_1[2][24] = fMin_1[2][24]*fScal_1[2][24]+1.;
   fMin_1[0][25] = 0.250044226646;
   fMax_1[0][25] = 2.88749480247;
   fScal_1[0][25] = 2.0/(fMax_1[0][25]-fMin_1[0][25]);
   fOff_1[0][25] = fMin_1[0][25]*fScal_1[0][25]+1.;
   fMin_1[1][25] = 0.250040501356;
   fMax_1[1][25] = 2.38550233841;
   fScal_1[1][25] = 2.0/(fMax_1[1][25]-fMin_1[1][25]);
   fOff_1[1][25] = fMin_1[1][25]*fScal_1[1][25]+1.;
   fMin_1[2][25] = 0.250040501356;
   fMax_1[2][25] = 2.88749480247;
   fScal_1[2][25] = 2.0/(fMax_1[2][25]-fMin_1[2][25]);
   fOff_1[2][25] = fMin_1[2][25]*fScal_1[2][25]+1.;
   fMin_1[0][26] = 0.136996492743;
   fMax_1[0][26] = 7.39313840866;
   fScal_1[0][26] = 2.0/(fMax_1[0][26]-fMin_1[0][26]);
   fOff_1[0][26] = fMin_1[0][26]*fScal_1[0][26]+1.;
   fMin_1[1][26] = 0.111182250082;
   fMax_1[1][26] = 9.55922031403;
   fScal_1[1][26] = 2.0/(fMax_1[1][26]-fMin_1[1][26]);
   fOff_1[1][26] = fMin_1[1][26]*fScal_1[1][26]+1.;
   fMin_1[2][26] = 0.111182250082;
   fMax_1[2][26] = 9.55922031403;
   fScal_1[2][26] = 2.0/(fMax_1[2][26]-fMin_1[2][26]);
   fOff_1[2][26] = fMin_1[2][26]*fScal_1[2][26]+1.;
   fMin_1[0][27] = 0.108272731304;
   fMax_1[0][27] = 2.3555893898;
   fScal_1[0][27] = 2.0/(fMax_1[0][27]-fMin_1[0][27]);
   fOff_1[0][27] = fMin_1[0][27]*fScal_1[0][27]+1.;
   fMin_1[1][27] = 0.106673195958;
   fMax_1[1][27] = 2.12867760658;
   fScal_1[1][27] = 2.0/(fMax_1[1][27]-fMin_1[1][27]);
   fOff_1[1][27] = fMin_1[1][27]*fScal_1[1][27]+1.;
   fMin_1[2][27] = 0.106673195958;
   fMax_1[2][27] = 2.3555893898;
   fScal_1[2][27] = 2.0/(fMax_1[2][27]-fMin_1[2][27]);
   fOff_1[2][27] = fMin_1[2][27]*fScal_1[2][27]+1.;
   fMin_1[0][28] = 0.00639545917511;
   fMax_1[0][28] = 1.63247573376;
   fScal_1[0][28] = 2.0/(fMax_1[0][28]-fMin_1[0][28]);
   fOff_1[0][28] = fMin_1[0][28]*fScal_1[0][28]+1.;
   fMin_1[1][28] = 0.00133723113686;
   fMax_1[1][28] = 1.645362854;
   fScal_1[1][28] = 2.0/(fMax_1[1][28]-fMin_1[1][28]);
   fOff_1[1][28] = fMin_1[1][28]*fScal_1[1][28]+1.;
   fMin_1[2][28] = 0.00133723113686;
   fMax_1[2][28] = 1.645362854;
   fScal_1[2][28] = 2.0/(fMax_1[2][28]-fMin_1[2][28]);
   fOff_1[2][28] = fMin_1[2][28]*fScal_1[2][28]+1.;
   fMin_1[0][29] = 0.00251884781756;
   fMax_1[0][29] = 0.951035797596;
   fScal_1[0][29] = 2.0/(fMax_1[0][29]-fMin_1[0][29]);
   fOff_1[0][29] = fMin_1[0][29]*fScal_1[0][29]+1.;
   fMin_1[1][29] = 0.000732800283004;
   fMax_1[1][29] = 1.67565762997;
   fScal_1[1][29] = 2.0/(fMax_1[1][29]-fMin_1[1][29]);
   fOff_1[1][29] = fMin_1[1][29]*fScal_1[1][29]+1.;
   fMin_1[2][29] = 0.000732800283004;
   fMax_1[2][29] = 1.67565762997;
   fScal_1[2][29] = 2.0/(fMax_1[2][29]-fMin_1[2][29]);
   fOff_1[2][29] = fMin_1[2][29]*fScal_1[2][29]+1.;
}

//_______________________________________________________________________
inline void ReadDNN_GPU::Transform_1( std::vector<double>& iv, int cls) const
{
   // Normalization transformation
   if (cls < 0 || cls > 2) {
   if (2 > 1 ) cls = 2;
      else cls = 2;
   }
   const int nVar = 30;

   // get indices of used variables

   // define the indices of the variables which are transformed by this transformation
   static std::vector<int> indicesGet;
   static std::vector<int> indicesPut;

   if ( indicesGet.empty() ) {
      indicesGet.reserve(fNvars);
      indicesGet.push_back( 0);
      indicesGet.push_back( 1);
      indicesGet.push_back( 2);
      indicesGet.push_back( 3);
      indicesGet.push_back( 4);
      indicesGet.push_back( 5);
      indicesGet.push_back( 6);
      indicesGet.push_back( 7);
      indicesGet.push_back( 8);
      indicesGet.push_back( 9);
      indicesGet.push_back( 10);
      indicesGet.push_back( 11);
      indicesGet.push_back( 12);
      indicesGet.push_back( 13);
      indicesGet.push_back( 14);
      indicesGet.push_back( 15);
      indicesGet.push_back( 16);
      indicesGet.push_back( 17);
      indicesGet.push_back( 18);
      indicesGet.push_back( 19);
      indicesGet.push_back( 20);
      indicesGet.push_back( 21);
      indicesGet.push_back( 22);
      indicesGet.push_back( 23);
      indicesGet.push_back( 24);
      indicesGet.push_back( 25);
      indicesGet.push_back( 26);
      indicesGet.push_back( 27);
      indicesGet.push_back( 28);
      indicesGet.push_back( 29);
   }
   if ( indicesPut.empty() ) {
      indicesPut.reserve(fNvars);
      indicesPut.push_back( 0);
      indicesPut.push_back( 1);
      indicesPut.push_back( 2);
      indicesPut.push_back( 3);
      indicesPut.push_back( 4);
      indicesPut.push_back( 5);
      indicesPut.push_back( 6);
      indicesPut.push_back( 7);
      indicesPut.push_back( 8);
      indicesPut.push_back( 9);
      indicesPut.push_back( 10);
      indicesPut.push_back( 11);
      indicesPut.push_back( 12);
      indicesPut.push_back( 13);
      indicesPut.push_back( 14);
      indicesPut.push_back( 15);
      indicesPut.push_back( 16);
      indicesPut.push_back( 17);
      indicesPut.push_back( 18);
      indicesPut.push_back( 19);
      indicesPut.push_back( 20);
      indicesPut.push_back( 21);
      indicesPut.push_back( 22);
      indicesPut.push_back( 23);
      indicesPut.push_back( 24);
      indicesPut.push_back( 25);
      indicesPut.push_back( 26);
      indicesPut.push_back( 27);
      indicesPut.push_back( 28);
      indicesPut.push_back( 29);
   }

   static std::vector<double> dv;
   dv.resize(nVar);
   for (int ivar=0; ivar<nVar; ivar++) dv[ivar] = iv[indicesGet.at(ivar)];
   for (int ivar=0;ivar<30;ivar++) {
      double offset = fOff_1[cls][ivar];
      double scale  = fScal_1[cls][ivar];
      iv[indicesPut.at(ivar)] = scale*dv[ivar]-offset;
   }
}

//_______________________________________________________________________
inline void ReadDNN_GPU::InitTransform()
{
   InitTransform_1();
}

//_______________________________________________________________________
inline void ReadDNN_GPU::Transform( std::vector<double>& iv, int sigOrBgd ) const
{
   Transform_1( iv, sigOrBgd );
}
